<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestão de Riscos Psicossociais - PRD-PRQ</title>
    
    <!-- Bootstrap CSS (carregado da CDN) -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css">
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css">
    <!-- CSS personalizado -->
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <!-- Barra de navegação -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container">
            <a class="navbar-brand" href="#">Projeto SGRP (Sistema de Gestão de Riscos Psicossociais)</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="#" data-page="home">Início</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" data-page="questionario">Questionário PRD-PRQ</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" data-page="relatorios">Relatório</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Conteúdo principal -  SPA (Single Page Application) -->
    <main class="container mt-4">
        <!-- Página Inicial -->
        <section id="home" class="page active">
            <div class="jumbotron p-4 bg-light rounded">
                <h1>Sistema de Gestão de Riscos Psicossociais</h1>
                <p class="lead">
                    Ferramenta para auxiliar organizações na identificação e gestão de riscos psicossociais no ambiente de trabalho,
                    utilizando o questionário Participative, Rapid and Detailed Psychosocial Risk Questionnaire (<a href="https://www.sciencedirect.com/science/article/abs/pii/S0925753524000298" class="text-decoration-underline">PRD-PRQ</a>).
                </p>         
                <hr class="my-4">
                <p>
                    O questionário PRD-PRQ é estruturado em dois níveis:
                </p>
                <ul>
                    <li><strong>Primeiro nível:</strong> 20 temas distribuídos em 5 macro temas, onde você seleciona apenas os que causam desconforto ou dor</li>
                    <li><strong>Segundo nível:</strong> Perguntas detalhadas somente sobre os temas selecionados, com respostas em escala de "Sem impacto" até "Dor intensa"</li>
                </ul>
                <p class="mt-3">
                    <a class="btn btn-primary btn-lg" href="#" role="button" data-page="questionario">Iniciar Questionário</a>
                </p>
            </div>

             <!-- Cards de benefícios/características principais do sistema -->
            <div class="row mt-5">
                <!-- Card: Avaliação Rápida -->
                <div class="col-md-4">
                    <div class="card mb-4">
                        <div class="card-body">
                            <h5 class="card-title"><i class="bi bi-shield-check me-2"></i>Conforme NR-1</h5>
                            <p class="card-text">Atualize a gestão de sua empresa para atender às novas exigências da NR-1 que agora incluem a identificação, avaliação e controle dos riscos psicossociais.</p>
                        </div>
                    </div>
                </div>
                <!-- Card: Relatórios Detalhados -->
                <div class="col-md-4">
                    <div class="card mb-4">
                        <div class="card-body">
                            <h5 class="card-title"><i class="bi bi-speedometer2 me-2"></i>Avaliação Rápida</h5>
                            <p class="card-text">O questionário é projetado para ser rápido e eficiente, focando apenas nos pontos relevantes para cada trabalhador.</p>
                        </div>
                    </div>
                </div>
                <!-- Card: Conformidade NR-1 -->
                <div class="col-md-4">
                    <div class="card mb-4">
                        <div class="card-body">
                            <h5 class="card-title"><i class="bi bi-graph-up me-2"></i>Relatórios Detalhados</h5>
                            <p class="card-text">Gere relatórios com estatísticas claras e recomendações práticas para gestores implementarem melhorias.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Página do Questionário (Wizard) -->
        <section id="questionario" class="page">
            <div class="wizard-container">
                <!-- Passo 1: Identificação -->
                <div class="wizard-step" id="step-identificacao">
                    <h2>Questionário PRD-PRQ</h2>
                    <div class="progress mb-4">
                        <div class="progress-bar" role="progressbar" style="width: 0%" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">0%</div>
                    </div>
                    
                    <h4 class="mb-3">Identificação</h4>
                    <form id="form-identificacao" class="mb-4">
                        <div class="row g-3">
                            <div class="col-md-6">
                                <label for="empresa" class="form-label">Empresa</label>
                                <input type="text" class="form-control" id="empresa" required>
                            </div>
                            <div class="col-md-6">
                                <label for="departamento" class="form-label">Departamento/Setor</label>
                                <input type="text" class="form-control" id="departamento" required>
                            </div>
                            <div class="col-12">
                                <label for="funcao" class="form-label">Função/Cargo</label>
                                <input type="text" class="form-control" id="funcao">
                            </div>
                        </div>
                        
                        <div class="d-flex justify-content-end mt-4">
                            <button type="submit" class="btn btn-primary">Continuar <i class="bi bi-arrow-right"></i></button>
                        </div>
                    </form>
                </div>
                
                <!-- Passo 2: Primeiro Nível -->
                <div class="wizard-step" id="step-nivel1" style="display: none;">
                    <h2>Questionário PRD-PRQ - Primeiro Nível</h2>
                    <div class="progress mb-4">
                        <div class="progress-bar" role="progressbar" style="width: 33%" aria-valuenow="33" aria-valuemin="0" aria-valuemax="100">33%</div>
                    </div>
                    
                    <div class="alert alert-info">
                        <p><strong>Instruções:</strong> Marque as afirmações que causam desconforto ou dor no trabalho. Se essas afirmações estão presentes no seu trabalho, mas não causam desconforto ou dor, não as selecione.</p>
                    </div>
                    
                    <form id="form-nivel1" class="mb-4">
                        <div id="temas-container">
                            <!-- Temas serão carregados dinamicamente aqui -->
                            <div class="text-center py-5">
                                <div class="spinner-border" role="status">
                                    <span class="visually-hidden">Carregando...</span>
                                </div>
                                <p class="mt-2">Carregando questionário...</p>
                            </div>
                        </div>
                        
                        <div class="d-flex justify-content-between mt-4">
                            <button type="button" class="btn btn-outline-secondary btn-voltar"><i class="bi bi-arrow-left"></i> Voltar</button>
                            <button type="submit" class="btn btn-primary">Continuar <i class="bi bi-arrow-right"></i></button>
                        </div>
                    </form>
                </div>
                
                <!-- Passo 3: Segundo Nível -->
                <div class="wizard-step" id="step-nivel2" style="display: none;">
                    <h2>Questionário PRD-PRQ - Segundo Nível</h2>
                    <div class="progress mb-4">
                        <div class="progress-bar" role="progressbar" style="width: 66%" aria-valuenow="66" aria-valuemin="0" aria-valuemax="100">66%</div>
                    </div>
                    
                    <div class="alert alert-info">
                        <p><strong>Instruções:</strong> Para cada item selecionado anteriormente, indique o nível de desconforto ou dor que os seguintes aspectos causam no seu trabalho.</p>
                    </div>
                    
                    <form id="form-nivel2" class="mb-4">
                        <div id="subtemas-container">
                            <!-- Subtemas serão carregados dinamicamente aqui -->
                        </div>
                        
                        <div class="d-flex justify-content-between mt-4">
                            <button type="button" class="btn btn-outline-secondary btn-voltar"><i class="bi bi-arrow-left"></i> Voltar</button>
                            <button type="submit" class="btn btn-primary">Finalizar <i class="bi bi-check-lg"></i></button>
                        </div>
                    </form>
                </div>
                
                <!-- Passo 4: Confirmação -->
                <div class="wizard-step" id="step-confirmacao" style="display: none;">
                    <h2>Questionário Enviado</h2>
                    <div class="progress mb-4">
                        <div class="progress-bar" role="progressbar" style="width: 100%" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100">100%</div>
                    </div>
                    
                    <div class="text-center py-5">
                        <div class="mb-4">
                            <i class="bi bi-check-circle-fill text-success" style="font-size: 5rem;"></i>
                        </div>
                        <h3 class="mb-3">Obrigado pela sua participação!</h3>
                        <p class="lead">Suas respostas foram registradas com sucesso e ajudarão a identificar e melhorar os riscos psicossociais no ambiente de trabalho.</p>
                        
                        <div class="mt-4">
                            <a href="#" class="btn btn-primary me-2" data-page="home">Voltar ao início</a>
                            <a href="#" class="btn btn-outline-primary" data-page="questionario" id="btn-novo-questionario">Responder novo questionário</a>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Página de Relatórios -->
        <section id="relatorios" class="page">
            <h2>Relatórios de Riscos Psicossociais</h2>
            
            <div class="card mt-3">
                <div class="card-header">
                    Filtros
                </div>
                <div class="card-body">
                    <div class="row g-2">
                        <div class="col-md-4">
                            <label for="filtro-empresa" class="form-label">Empresa</label>
                            <input type="text" class="form-control" id="filtro-empresa" placeholder="Todas as empresas">
                        </div>
                        <div class="col-md-4">
                            <label for="filtro-departamento" class="form-label">Departamento</label>
                            <input type="text" class="form-control" id="filtro-departamento" placeholder="Todos os departamentos">
                        </div>
                        <div class="col-md-4 d-flex align-items-end">
                            <button class="btn btn-primary w-100" id="btn-gerar-relatorio">Gerar Relatório</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Conteúdo do relatório -->
            <div id="relatorio-container" class="mt-4" style="display: none;">
                <div class="card mb-4">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <span>Resumo do Relatório</span>
                        <button class="btn btn-sm btn-outline-primary" id="btn-exportar-pdf">
                            <i class="bi bi-file-earmark-pdf"></i> Exportar PDF
                        </button>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-4 text-center border-end">
                                <h7>Total de Avaliações</h7>
                                    <br>
                                <span id="total-avaliacoes" class="small">0</span>
                            </div>
                            <div class="col-md-4 text-center border-end">
                                <h7>Empresa</h7>
                                <p id="empresa-relatorio" class="small">Todas</p>
                            </div>
                            <div class="col-md-4 text-center">
                                <h7>Departamento</h7>
                                <p id="departamento-relatorio" class="small">Todos</p>
                            </div>
                        </div>
                    </div>
                </div>

            <!-- Legenda de Níveis de Risco para os gráficos -->
            <h5>Gráficos</h5>
            <div id="legenda-top-riscos" class="card mb-3" style="display: none;">
                <div class="card-header bg-light">
                    <span class="mb-0" style="font-size: 0.9rem; font-weight: normal;">Legenda de Níveis de Risco</span>
                </div>
                <div class="card-body" style="padding: 0.75rem;">
                    <div style="display: flex; flex-wrap: wrap; gap: 10px; justify-content: space-between;">
                        <div style="display: flex; align-items: center; flex: 1 0 18%;">
                            <span style="display: inline-block; width: 15px; height: 15px; background-color: rgba(40, 129, 167, 0.6); margin-right: 8px; border-radius: 3px;"></span>
                            <span style="font-size: 10px;">Ausência de Risco (0-0.5)</span>
                        </div>
                        <div style="display: flex; align-items: center; flex: 1 0 18%;">
                            <span style="display: inline-block; width: 15px; height: 15px; background-color: rgba(0, 255, 123, 0.6); margin-right: 8px; border-radius: 3px;"></span>
                            <span style="font-size: 10px;">Risco Baixo (0.5-1.5)</span>
                        </div>
                        <div style="display: flex; align-items: center; flex: 1 0 18%;">
                            <span style="display: inline-block; width: 15px; height: 15px; background-color: rgba(255, 193, 7, 0.6); margin-right: 8px; border-radius: 3px;"></span>
                            <span style="font-size: 10px;">Risco Moderado (1.5-2.5)</span>
                        </div>
                        <div style="display: flex; align-items: center; flex: 1 0 18%;">
                            <span style="display: inline-block; width: 15px; height: 15px; background-color: rgba(245, 50, 70, 0.6); margin-right: 8px; border-radius: 3px;"></span>
                            <span style="font-size: 10px;">Risco Alto (2.5-3.5)</span>
                        </div>
                        <div style="display: flex; align-items: center; flex: 1 0 18%;">
                            <span style="display: inline-block; width: 15px; height: 15px; background-color: rgba(7, 7, 7, 0.8); margin-right: 8px; border-radius: 3px;"></span>
                            <span style="font-size: 10px;">Risco Crítico (3.5+)</span>
                        </div>
                    </div>
                </div>
            </div>
                
                <!-- Gráfico de Top Riscos -->
                <div class="card mb-4">
                    <div class="card-header">Top Riscos Psicossociais</div>
                    <div class="card-body">
                        <canvas id="grafico-top-riscos" height="200"></canvas>
                    </div>
                </div>

                <!-- Gráfico de visualização de todos os riscos -->               
                <div class="card mb-4 no-hover">
                    <div class="card-header"> Visão Geral - Total</div>
                    <div class="card-body">
                        <canvas id="grafico-todos-riscos" height="200"></canvas>
                    </div>
                </div>
                
                <!-- Detalhamento dos riscos -->
                <h5>Detalhamento dos Riscos</h5>
                <div id="detalhamento-riscos">
                    <!-- Detalhamento é carregado dinamicamente -->
                </div>
            </div>
            
            <!-- Mensagem quando não há dados -->
            <div id="sem-dados-relatorio" class="text-center py-5">
                <p class="lead text-muted">Utilize os filtros acima e clique em "Gerar Relatório" para visualizar os dados.</p>
            </div>
        </section>
    </main>

    <!-- Rodapé -->
    <footer class="footer mt-auto py-3 bg-light">
        <div class="container text-center">
            <span class="text-muted"> Em caso de dúvidas, entrar em contato: <a href="mailto:perseupadre@gmail.com">perseupadre@gmail.com</a></span>        
        </div>
        <div class="container text-center">
            <span class="text-muted">SGRP (Sistema de Gestão de Riscos Psicossociais) © 2025</span>
        </div>
    </footer>

    <!-- Modal de notificação -->
    <div class="modal fade" id="notification-modal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="modal-title">Notificação</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body" id="modal-message">
                    Mensagem aqui
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" data-bs-dismiss="modal">OK</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="js/api.js"></script>
    <script src="js/questionario.js"></script>
    <script src="js/relatorio.js"></script>
    <script src="js/app.js"></script>
    <script src="js/principal.js"></script>
    <script src="js/charts.js"></script>
    
</body>
</html>
